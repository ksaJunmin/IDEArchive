import{h as b,i as A,j as H,r as p,o as T,a as C,b as a,c as s,d as e,t as o,e as i,F as D,g as E,w as P,f,k as S,p as U,l as z}from"./index-1f07c82d.js";import{P as F}from"./PostService-a555de4f.js";import{_ as M}from"./MathRenderer-eac4ecc0.js";const V="http://localhost:3000/comments";class q{async fetchComments(r){return(await b.get(`${V}/${r}`)).data}async addComment(r,c,v){return(await b.post(`${V}/${r}`,{content:c},{headers:{Authorization:`Bearer ${v}`}})).data}async addReply(r,c,v){return(await b.post(`${V}/${r}/reply`,{content:c},{headers:{Authorization:`Bearer ${v}`}})).data}}const $=_=>(U("data-v-89ef63bb"),_=_(),z(),_),G={class:"grid"},J={class:"col-12"},K={class:"card"},O={key:0},Q={class:"flex flex-row gap-2 mt-4 align-items-center"},W={class:"text-gray-500"},X={class:"surface-100 p-1",style:{"border-radius":"30px"}},Y={class:"surface-0 flex align-items-center gap-2 justify-content-center py-1 px-2",style:{"border-radius":"30px","box-shadow":"0px 1px 2px 0px rgba(0, 0, 0, 0.04), 0px 1px 2px 0px rgba(0, 0, 0, 0.06)"}},Z={class:"text-900 font-medium text-sm"},ee=$(()=>e("i",{class:"pi pi-thumbs-up"},null,-1)),te={key:0,class:"font-medium"},oe={key:1,class:"font-medium"},ae={class:"flex flex-column mt-4 align-items-center justify-center"},se={class:"flex gap-2"},ne=$(()=>e("h3",null,"댓글",-1)),le={key:0},re={key:0},ce={key:0},ie={key:1},de=$(()=>e("p",null,"로그인 후 댓글을 작성할 수 있습니다.",-1)),ue=[de],pe={__name:"postHowto",setup(_){const r=new F,c=new q,v=H(),u=p(v.params.postId),n=p(null),y=localStorage.getItem("token"),R=async()=>{try{const t=await r.updateLike(y,u.value);n.value=t}catch(t){console.error("Error updating like:",t)}},B=p([]),h=p(""),m=p({}),x=p(!1),w=async()=>{try{B.value=await c.fetchComments(u.value)}catch(t){console.error("Error fetching comments:",t)}},N=async()=>{if(h.value)try{await c.addComment(u.value,h.value,y),h.value="",await w()}catch(t){console.error("Error adding comment:",t)}},j=async t=>{if(m.value[t])try{await c.addReply(t,m.value[t],y),m.value[t]="",await w()}catch(g){console.error("Error adding reply:",g)}};return T(async()=>{try{const t=await r.getPostById(u.value);n.value=t.post,file.value=t.file}catch(t){console.error("Error fetching post:",t)}try{await w(),x.value=!!y}catch(t){console.error("Error fetching comments:",t)}}),(t,g)=>{const I=C("Divider"),k=C("Button"),L=C("Textarea");return a(),s("div",G,[e("div",J,[e("div",K,[n.value?(a(),s("div",O,[e("h2",null,o(n.value.title),1),e("div",null,[e("div",Q,[e("div",W,o(new Date(n.value.date).toLocaleString()),1),e("div",X,[e("div",Y,[e("div",Z,o(n.value.like),1),ee])])]),e("div",null,o(n.value.author.schoolID)+" "+o(n.value.author.name),1)]),i(I),n.value.islatex==1?(a(),s("div",te,[i(M,{content:n.value.content},null,8,["content"])])):(a(),s("div",oe,o(n.value.content),1)),e("div",null,[e("div",ae,[e("div",se,[i(k,{label:t.isLiked?"좋아요 취소":"좋아요",icon:"pi pi-thumbs-up",onClick:R},null,8,["label"])])])]),i(I),e("div",null,[ne,e("div",null,[(a(!0),s(D,null,E(B.value,l=>(a(),s("div",{key:l._id},[l.isReply?S("",!0):(a(),s("div",le,[e("p",null,[e("strong",null,o(l.author.name)+":",1),f(" "+o(l.content),1)]),e("small",null,o(new Date(l.date).toLocaleString()),1),(a(!0),s(D,null,E(l.replies,d=>(a(),s("div",{key:d._id,class:"reply"},[e("p",null,[e("strong",null,o(d.author.name)+":",1),f(" "+o(d.content),1)]),e("small",null,o(new Date(d.date).toLocaleString()),1)]))),128)),x.value?(a(),s("div",re,[i(L,{modelValue:m.value[l._id],"onUpdate:modelValue":d=>m.value[l._id]=d,placeholder:"답글을 입력하세요"},null,8,["modelValue","onUpdate:modelValue"]),i(k,{onClick:d=>j(l._id)},{default:P(()=>[f("답글 추가")]),_:2},1032,["onClick"])])):S("",!0)]))]))),128))]),x.value?(a(),s("div",ce,[i(L,{modelValue:h.value,"onUpdate:modelValue":g[0]||(g[0]=l=>h.value=l),placeholder:"댓글을 입력하세요"},null,8,["modelValue"]),i(k,{onClick:N},{default:P(()=>[f("댓글 추가")]),_:1})])):(a(),s("div",ie,ue))]),f(" "+o(t.file),1)])):S("",!0)])])])}}},me=A(pe,[["__scopeId","data-v-89ef63bb"]]);export{me as default};
