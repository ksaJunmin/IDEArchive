import{k as w,_ as A,l as U,r as u,o as j,a as b,b as o,c as s,e,t as a,d as m,F as I,g as L,m as E,v as V,q as C,f as R,p as F,h as M}from"./index-a1cc3ecb.js";import{P as q}from"./PostService-387735df.js";const S="https://port-0-idearchive-ss7z32llwmxnho4.sel5.cloudtype.app/comments";class G{async fetchComments(l){return(await w.get(`${S}/${l}`)).data}async addComment(l,c,p){return(await w.post(`${S}/${l}`,{content:c},{headers:{Authorization:`Bearer ${p}`}})).data}async addReply(l,c,p){return(await w.post(`${S}/${l}/reply`,{content:c},{headers:{Authorization:`Bearer ${p}`}})).data}}const y=_=>(F("data-v-ce8b5aef"),_=_(),M(),_),H={class:"grid"},J={class:"col-12"},K={class:"card"},O={key:0},Q={class:"flex flex-row gap-2 mt-4 align-items-center"},W={class:"text-gray-500"},X={class:"surface-100 p-1",style:{"border-radius":"30px"}},Y={class:"surface-0 flex align-items-center gap-2 justify-content-center py-1 px-2",style:{"border-radius":"30px","box-shadow":"0px 1px 2px 0px rgba(0, 0, 0, 0.04), 0px 1px 2px 0px rgba(0, 0, 0, 0.06)"}},Z={class:"text-900 font-medium text-sm"},ee=y(()=>e("i",{class:"pi pi-thumbs-up"},null,-1)),te={key:0},oe={key:1},se={class:"font-medium"},ae={class:"flex flex-column mt-4 align-items-center justify-center"},ne={class:"flex gap-2"},re=y(()=>e("div",{class:"text-gray-500"},"댓글 0",-1)),le={class:"flex gap-2"},ce=y(()=>e("h3",null,".",-1)),ie=y(()=>e("h3",null,"댓글",-1)),de={key:0},ue={key:0},_e=["onUpdate:modelValue"],pe=["onClick"],ve={key:0},he={key:1},me=y(()=>e("p",null,"로그인 후 댓글을 작성할 수 있습니다.",-1)),ye=[me],xe={__name:"post",setup(_){const l=new q,c=new G,p=U(),d=u(p.params.postId),r=u(null),x=localStorage.getItem("token"),P=async()=>{try{const t=await l.updateLike(x,d.value);r.value=t}catch(t){console.error("Error updating like:",t)}},$=u([]),v=u(""),h=u({}),f=u(!1),k=async()=>{try{$.value=await c.fetchComments(d.value)}catch(t){console.error("Error fetching comments:",t)}},z=async()=>{if(v.value)try{await c.addComment(d.value,v.value,x),v.value="",await k()}catch(t){console.error("Error adding comment:",t)}},N=async t=>{if(h.value[t])try{await c.addReply(t,h.value[t],x),h.value[t]="",await k()}catch(g){console.error("Error adding reply:",g)}};return j(async()=>{try{const t=await l.getPostById(d.value);r.value=t}catch(t){console.error("Error fetching post:",t)}try{await k(),f.value=!!x}catch(t){console.error("Error fetching comments:",t)}}),(t,g)=>{const B=b("Divider"),D=b("Button"),T=b("Textarea");return o(),s("div",H,[e("div",J,[e("div",K,[r.value?(o(),s("div",O,[e("h2",null,a(r.value.title),1),e("div",null,[e("div",Q,[e("div",W,a(new Date(r.value.date).toLocaleString()),1),e("div",X,[e("div",Y,[e("div",Z,a(r.value.like),1),ee])]),r.value.author?(o(),s("div",te,a(r.value.author.schoolID)+" "+a(r.value.author.name),1)):(o(),s("div",oe," 옛날 글 "))])]),m(B),e("div",se,a(r.value.content),1),e("div",null,[e("div",ae,[e("div",ne,[m(D,{label:t.isLiked?"좋아요 취소":"좋아요",icon:"pi pi-thumbs-up",onClick:P},null,8,["label"])])])]),m(B),re,e("div",le,[m(T,{placeholder:"댓글을 입력하세요",autoResize:!0,rows:"1",cols:"50"}),m(D,{label:"입력",class:"mr-10 mb-10"})]),e("div",null,[ce,ie,e("div",null,[(o(!0),s(I,null,L($.value,n=>(o(),s("div",{key:n._id},[n.isReply?C("",!0):(o(),s("div",de,[e("p",null,[e("strong",null,a(n.author.name)+":",1),R(" "+a(n.content),1)]),e("small",null,a(new Date(n.date).toLocaleString()),1),(o(!0),s(I,null,L(n.replies,i=>(o(),s("div",{key:i._id,class:"reply"},[e("p",null,[e("strong",null,a(i.author.name)+":",1),R(" "+a(i.content),1)]),e("small",null,a(new Date(i.date).toLocaleString()),1)]))),128)),f.value?(o(),s("div",ue,[E(e("textarea",{"onUpdate:modelValue":i=>h.value[n._id]=i,placeholder:"답글을 입력하세요"},null,8,_e),[[V,h.value[n._id]]]),e("button",{onClick:i=>N(n._id)},"답글 추가",8,pe)])):C("",!0)]))]))),128))]),f.value?(o(),s("div",ve,[E(e("textarea",{"onUpdate:modelValue":g[0]||(g[0]=n=>v.value=n),placeholder:"댓글을 입력하세요"},null,512),[[V,v.value]]),e("button",{onClick:z},"댓글 추가")])):(o(),s("div",he,ye))])])):C("",!0)])])])}}},ke=A(xe,[["__scopeId","data-v-ce8b5aef"]]);export{ke as default};
